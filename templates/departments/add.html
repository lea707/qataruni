{% extends "base.html" %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/department_form.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css" />
{% endblock %}
{% block content %}
<div class="department-form-container">
<h1>Add New Department</h1>
<form method="POST">
    <div class="form-group">
        <label for="name">Department Name</label>
        <input type="text" id="name" name="name" required>
    </div>
    <div class="form-group">
        <label for="director_emp_id">Director (Employee)</label>
        <input id="director_emp_id" name="director_emp_id" class="awesomplete" placeholder="Type to search..." autocomplete="off">
    </div>
    <div class="form-group">
        <label for="parent_department_id">Parent Department</label>
        <input id="parent_department_id" name="parent_department_id" class="awesomplete" placeholder="Type to search..." autocomplete="off">
    </div>
    <div class="form-actions">
        <button type="submit" class="btn">Save</button>
        <a href="{{ url_for('list_departments') }}" class="btn btn-secondary">Cancel</a>
    </div>
</form>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>
<script>
// Prepare the options for Awesomplete
var directorList = [
    {% for emp in employees %}
        "{{ emp.english_name|e }} ({{ emp.busness_id|e }})"{% if not loop.last %},{% endif %}
    {% endfor %}
];
var departmentList = [
    {% for dept in departments %}
        "{{ dept.department_name|e }}"{% if not loop.last %},{% endif %}
    {% endfor %}
];
new Awesomplete(document.getElementById("director_emp_id"), {
    list: directorList,
    minChars: 1,
    maxItems: 10,
    autoFirst: true
});
new Awesomplete(document.getElementById("parent_department_id"), {
    list: departmentList,
    minChars: 1,
    maxItems: 10,
    autoFirst: true
});
</script>
{% endblock %}